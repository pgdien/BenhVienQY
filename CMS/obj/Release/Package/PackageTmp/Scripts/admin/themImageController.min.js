myApp.controller("themImageController",["$scope","$http","$window","$location","$filter","Alias","MenuMultiLevel","Url",function(n,t,i,r,u,f,e,o){n.image={};n.chooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.image.anh=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.currentIdImage=o.getParameterByName("id");n.currentIdImage?t.get("/API/ImagesAPI/"+n.currentIdImage).success(function(t){n.image={id:t.id,timeCreated:t.timeCreated,timeModified:t.timeModified,title:t.title,alias:t.alias,content:t.content,note:t.note,description:t.description,published:t.published,anh:t.anh,tags:t.tags,deleted:t.deleted,featured:t.featured,metadescription:t.metadescription,metakewords:t.metakewords,author:t.author,robots:t.robots}}):n.image={published:1,featured:0,robots:"Index, Follow",timeCreated:new Date,timeModified:new Date};t.get("/API/CategoriesAPI/").success(function(t){n.categories=e.getDropdownMenu(t)});n.saveImage=function(){n.currentIdImage?(n.image.timeModified=new Date,t.put("/API/ImagesAPI/"+n.image.id,n.image).success(function(){toastr.success("Thành công","Lưu thư viện ảnh")}).error(function(){toastr.error("Thất bại","Thêm thư viện ảnh")})):t.post("/API/ImagesAPI/",n.image).success(function(){toastr.success("Thành công","Thêm thư viện ảnh");i.location.href="/Admin/Images"}).error(function(){toastr.error("Thất bại","Thêm thư viện ảnh")})};n.saveImageAndExit=function(){n.currentIdImage?(n.image.timeModified=new Date,t.put("/API/ImagesAPI/"+n.image.id,n.image).success(function(){i.location.href="/Admin/Images"}).error(function(){toastr.error("Thất bại","Lưu thư viện ảnh")})):t.post("/API/ImagesAPI/",n.image).success(function(){i.location.href="/Admin/Images"}).error(function(){toastr.error("Thất bại","Thêm thư viện ảnh")})};n.saveImageAndNew=function(){n.currentIdImage?(n.image.timeModified=new Date,t.put("/API/ImagesAPI/"+n.image.id,n.image).success(function(){i.location.href="/Admin/Images/Create"}).error(function(){toastr.error("Thất bại","Lưu Danh mục")})):t.post("/API/ImagesAPI/",n.image).success(function(){i.location.href="/Admin/Images/Create"}).error(function(){toastr.error("Thất bại","Thêm thư viện ảnh")})};n.cancel=function(){i.location.href="/Admin/Images"};n.changeTitle=function(){n.image.alias=f.genAlias(n.image.title)}}]);
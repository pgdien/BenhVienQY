(function(n){function t(){var n=document.documentElement,t=window.innerWidth||self.innerWidth||n&&n.clientWidth||document.body.clientWidth,e;t-=18;var i=window.innerHeight||self.innerHeight||n&&n.clientHeight||document.body.clientHeight,o=window.pageXOffset||self.pageXOffset||n&&n.scrollLeft||document.body.scrollLeft,s=window.pageYOffset||self.pageYOffset||n&&n.scrollTop||document.body.scrollTop,r=window.innerWidth||document.body.scrollWidth||document.body.offsetWidth,u=window.innerHeight+window.scrollMaxY||document.body.scrollHeight||document.body.offsetHeight,f=r<t?t:r;return f-=18,e=u<i?i:u,arrayPageSize=[f,e,o,s,t,i]}n.fn.divbox=function(i){function e(i,o){var s={},d,c,v;s.closed=function(){n("#divbox_frame").animate({top:y.top,left:y.left,width:"0px",height:"0px"},r.speed,function(){n(this).remove();n("#divbox").remove();s.toggleObj("body","show");typeof r.api.closed=="function"&&r.api.closed(this)})};s.toggleObj=function(t,i){k&&(i=="show"?n(t).find("embed,object,select").show():n(t).find("embed,object,select").hide())};s.init=function(){typeof r.api.start=="function"&&r.api.start(a);n("#divbox,#divbox_frame,#divbox_content,#divbox_ajax").remove();n(r.container).prepend('<div id="divbox"><\/div><div id="divbox_ajax"><\/div><div id="divbox_frame"><div class="closed" title="'+r.languages.btn_close+'"><\/div><div id="divbox_data"><div id="divbox_content"><\/div><div class="prev" title="'+r.languages.btn_prev+'"><\/div><div class="caption"><\/div><div class="number">10/10<\/div><div class="next" title="'+r.languages.btn_next+'"><\/div><\/div><\/div>');n(r.btn_closed+","+r.btn_next+","+r.btn_prev+","+r.btn_number).hide();r.overlay&&n("#divbox").css({width:h[0]+"px",height:h[1]+"px",position:"absolute",zIndex:"10001",left:"0",top:"0"}).click(function(){s.closed()});n("#divbox_frame").css({position:"absolute",top:y.top,left:y.left,zIndex:"10002",width:0,height:0}).animate({width:50,height:50,top:r.top?h[3]+r.top:h[3]+Math.round(h[5]/2),left:r.left?h[2]+r.left:Math.round(h[4]/2)})};s.resizeWindow=function(){var i=t(p),u,f;n("#divbox").css({width:i[0]+"px",height:i[1]+"px"});u=n(v).outerWidth();f=n(v).outerHeight();n(v).css({top:r.top?i[3]+r.top:i[3]+Math.round((i[5]-f)/2),left:r.left?i[2]+r.left:Math.round((i[4]-u)/2)})};s.animate=function(t,u,f,e,o,c,l){n("#divbox").unbind("click");n(document).unbind("keydown");n(r.btn_closed+","+r.btn_next+","+r.btn_prev+","+r.btn_number).hide();var a=0;n(v).removeClass("white").animate({left:r.left?r.left:u,width:r.width?r.width+a:f+a},r.speed).animate({top:r.top?h[3]+r.top:t,height:r.height?r.height:e},r.speed,function(){var t,u,f,h,a;s.toggleObj("body");t=n("#divbox_content");typeof r.api.beginLoad=="function"&&r.api.beginLoad(t);typeof o=="function"&&o(t);typeof r.api.afterLoad=="function"&&r.api.afterLoad(t);n(r.btn_closed).show().click(function(){typeof c=="function"&&c(t);s.closed()});n("#divbox").bind("click",function(){typeof c=="function"&&c(t);s.closed()});n(this).addClass("white");u=n(v).find(".caption");r.caption!=!1&&(l!=""||r.caption_control==!0)&&(f=u.outerHeight(!0),n(v).animate({height:e+f}).find(".caption").show(),r.caption_control==!0?(h=e+parseInt(u.css("padding-top")),n(r.btn_prev+","+r.btn_next+","+r.btn_number).css({top:h}).show(),i*1>0?n(r.btn_prev).removeClass("prevDisabled").bind("click",function(){s.prevItem(i)}):n(r.btn_prev).addClass("prevDisabled").unbind("click"),r.caption_number?n(r.btn_number).html(i*1+1+"/"+w):n(r.btn_number).remove(),i*1<w-1?n(r.btn_next).removeClass("nextDisabled").bind("click",function(){s.nextItem(i)}):n(r.btn_next).addClass("nextDisabled").unbind("click")):n(u).css({"padding-left":"5px","padding-right":"5px"}));n(document).bind("keydown",function(t){var u=t?t.keyCode:event.keyCode;if(u==27&&(typeof c=="function"&&c(n("#divbox_content")),s.closed()),r.caption!=""&&r.caption_control==!0){if(u==38||u==39)return s.nextItem(i),!1;if(u==37||u==40)return s.prevItem(i),!1}});try{a=r.caption==!1?"#divbox_frame":"#divbox_frame .caption";n("#divbox_frame").draggable({handle:n(a)}).css({cursor:"move"});r.full_drag_handle||n("#divbox_content").css({cursor:"pointer"})}catch(y){}n(window).bind("resize scroll",function(){s.resizeWindow()})})};s.prevItem=function(n){n*1>0&&e(n*1-1)};s.nextItem=function(n){n*1<w-1&&e(n*1+1)};s.parseType=function(n){if(r.type)return r.type;if(n.match(/youtube\.com\/watch/i))return"youtube";var t=n.split("."),i=t[t.length-1];return i.toLowerCase()};s.viewImage=function(t,i){n("#divbox_content").html('<img src="'+t+'" />').find("img").hide();var u=new Image;u.onload=function(){var c,l;n("#divbox_content img").attr("src",t);var f=u.width,e=u.height,o=0;r.resize_large_image&&(f>=h[4]-100||e>=h[5]-100)&&(f>=h[4]-100&&(f=h[4]-100,e=Math.round(f*u.height/u.width)),e>=h[5]-100&&(tH=h[5]-100,f=Math.round(f*tH/e),e=tH),r.click_full_image&&(o=1));c=h[3]+Math.round((h[5]-e)/2);l=Math.round((h[4]-f)/2);s.animate(c,l,f,e,function(i){k&&b=="png"?n(i).find("img").wrap('<span style="display:inline-block;width: '+f+"px;height: "+e+"px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+t+');"><\/span>'):n(i).find("img").css({width:f,height:e,display:"block"}).fadeIn();o&&n(i).find("img").addClass("zoom").attr({title:r.languages.click_full_image}).click(function(){window.open(t,"wDivBox")})},!1,i);u.onload=function(){}};u.src=t};s.flashEmbedString=function(n,t,i,u){var e="&provider=video",o=u=="swf"?n:r.path+"jwplayer.swf",f;return u=="mp3"&&(e="&provider=sound"),f='<object id="player" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" name="player" width="'+t+'" height="'+i+'">',f+='<param name="movie" value="'+o+'" />',f+='<param name="allowfullscreen" value="true" />',u!="swf"&&(f+='<param name="flashvars" value="file='+n+"&autostart=true"+e+'" />'),f+='<embed  pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" quality="high"',f+=' type="application/x-shockwave-flash"',f+=' id="player2"',f+=' name="player2"',f+=' src="'+o+'" ',f+=' width="'+t+'" ',f+=' height="'+i+'"',f+=' allowfullscreen="true"',u!="swf"&&(f+=' flashvars="file='+n+"&start=true&autostart=true"+e+'" '),f+=" />",f+"<\/object>"};s.viewFLV=function(t,i){var r=400,u=300,f=h[3]+Math.round((h[5]-u)/2),e=Math.round((h[4]-r)/2),o=s.flashEmbedString(a.href,r,u,"flv");s.animate(f,e,r,u,function(t){n(t).html(o)},!1,i)};s.viewMP4=function(t,i){var r=400,u=300,f=h[3]+Math.round((h[5]-u)/2),e=Math.round((h[4]-r)/2),o=s.flashEmbedString(a.href,r,u,"mp4");s.animate(f,e,r,u,function(t){n(t).html(o)},!1,i)};s.viewMP3=function(t,i){var r=320,u=80,f=h[3]+Math.round((h[5]-u)/2),e=Math.round((h[4]-r)/2),o=s.flashEmbedString(t,r,u,"mp3");s.animate(f,e,r,u,function(t){n(t).html(o)},!1,i)};s.viewWMV=function(t,i){var u=400,f=300,e=h[3]+Math.round((h[5]-f)/2),o=Math.round((h[4]-u)/2),r='<object  type="application/x-oleobject" classid="CLSID:22D6f312-B0F6-11D0-94AB-0080C74C7E95" codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112"';r+=' width="'+u+'" height="'+f+'">';r+='<param name="filename" value="'+t+'" />';r+='<param name="Showcontrols" value="true" />';r+='<param name="autoStart" value="true" />';r+='<embed type="application/x-mplayer2" src="'+t+'" Showcontrols="true" autoStart="true" width="'+u+'" height="'+f+'"><\/embed>';r+="<object/>";s.animate(e,o,u,f,function(t){n(t).html(r)},!1,i)};s.viewSWF=function(t,i){var r=400,u=300,f=h[3]+Math.round((h[5]-u)/2),e=Math.round((h[4]-r)/2),o=s.flashEmbedString(t,r,u,"swf");s.animate(f,e,r,u,function(t){n(t).html(o)},!1,i)};s.viewElement=function(t){var i="#"+n(a).attr("rel"),r=n(i).outerWidth(),u=n(i).outerHeight(),f=h[3]+Math.round((h[5]-u)/2),e=Math.round((h[4]-r)/2);s.animate(f,e,r,u,function(t){n(t).html(n(i).html());s.toggleObj(t,"show");n(i).html("")},function(t){n(i).html(n(t).html())},t)};s.viewAjax=function(t,i){n.ajax({url:t,success:function(t){r.width&&n("#divbox_ajax").css({width:r.width});r.height&&n("#divbox_ajax").css({height:r.height});n("#divbox_ajax").html(t);var u=n("#divbox_ajax").outerWidth(),f=n("#divbox_ajax").outerHeight(),e=h[3]+Math.round((h[5]-f)/2),o=Math.round((h[4]-u)/2);s.animate(e,o,u,f,function(i){n(i).html(t);n("#divbox_ajax").remove()},!1,i)},error:function(n){alert(r.languages.error_cannot_load+n.responseText)}})};s.viewDefault=function(t,i){var u=h[4]-100,f=h[5]-100,e=h[3]+Math.round((h[5]-f)/2),o=h[2]+Math.round((h[4]-u)/2);s.animate(e,o,u,f,function(i){n(i).html('<iframe src="'+t+'" width="'+(u-12)+'" frameborder="0" scrolling="'+r.scrollbar+'" height="'+f+'"><\/iframe>')},!1,i)};s.viewYouTube=function(t,i){if(!t.match(/youtube\.com\/watch/i))return alert(r.languages.error_not_youtube),!1;var o=t.split("v=")[1].split("&")[0],e="http://www.youtube.com/v/"+o+"&hl=en&fs=1&autoplay=1&rel=0",u=640,f=385,c=h[3]+Math.round((h[5]-f)/2),l=Math.round((h[4]-u)/2),a='<object width="'+u+'" height="'+f+'"><param name="movie" value="'+e+'"><\/param><param name="allowFullScreen" value="true"><\/param><param name="allowscriptaccess" value="always"><\/param><embed src="'+e+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="'+u+'" height="'+f+'"><\/embed><\/object>';s.animate(c,l,u,f,function(t){n(t).html(a)},!1,i)};var a=u[i],p=n.browser.msie,k=p&&parseInt(n.browser.version)==6?!0:!1,h=t(p),w=n(f).length,y=n(a).offset(),l=n(a).attr(r.src).toString(),b=s.parseType(l);for(d in r.download_able)if(b==r.download_able[d])return window.open(l);c="";typeof r.caption=="function"?c=r.caption(a):r.caption===!0&&(c=n(a).attr("title"));o&&s.init();n(r.btn_prev).unbind("click");n(r.btn_next).unbind("click");v=n("#divbox_frame");n(v).find(".caption").hide().html(c);switch(b){case"jpg":case"jpeg":case"gif":case"png":s.viewImage(l,c);break;case"flv":s.viewFLV(l,c);break;case"wmv":s.viewWMV(l,c);break;case"mp3":s.viewMP3(l,c);break;case"mp4":s.viewMP4(l,c);break;case"swf":s.viewSWF(l,c);break;case"element":s.viewElement(c);break;case"ajax":s.viewAjax(l,c);break;case"youtube":s.viewYouTube(l,c);break;default:s.viewDefault(l,c)}return!1}var r={width:null,height:null,speed:500,left:null,top:null,type:null,src:"href",scrollbar:"auto",btn_closed:"#divbox_frame .closed",btn_prev:"#divbox_frame .prev",btn_next:"#divbox_frame .next",btn_number:"#divbox_frame .number",path:"players/",full_drag_handle:!1,resize_large_image:!0,click_full_image:!0,overlay:!0,caption:!0,caption_control:!0,caption_number:!1,event:"click",container:document.body,download_able:["pdf","zip","gz","rar","doc","docx","xls","xslx","ppt","pptx","csv"],languages:{btn_close:"Close",btn_next:"Next",btn_prev:"Prev",click_full_image:"Click on here to view full image",error_not_youtube:"This is not a youtube link",error_cannot_load:"We can't load this page\nError: "},api:{start:null,beginLoad:null,afterLoad:null,closed:null}},f,u;i&&n.extend(r,i);f=this;u=[];n(f).each(function(n,t){u[n]=t});n(f).bind(r.event,function(){var n=0;for(var t in u)u[t]===this&&(n=t);return e(n,!0),!1})}})(jQuery);